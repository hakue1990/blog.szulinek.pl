<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Traefik, Docker and SSL | IT Tech Anytime</title><meta name=keywords content="docker,traefik"><meta name=description content="Traefik reverse proxy"><meta name=author content="Adam"><link rel=canonical href=https://canonical.url/to/page><link crossorigin=anonymous href=/assets/css/stylesheet.cb2ba463b21cd55ccebc7e63bb8cfa6b32887f84b96fdab5a1fa38e91370b35b.css integrity="sha256-yyukY7Ic1VzOvH5ju4z6azKIf4S5b9q1ofo46RNws1s=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://szulinek.pl/assets/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://szulinek.pl/assets/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://szulinek.pl/favicon-32x32.png><link rel=apple-touch-icon href=https://szulinek.pl/assets/favicon/apple-touch-icon.png><link rel=mask-icon href=https://szulinek.pl/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://szulinek.pl/en/posts/traefik-docker/><link rel=alternate hreflang=pl href=https://szulinek.pl/pl/posts/traefik-docker/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Traefik, Docker and SSL"><meta property="og:description" content="Traefik reverse proxy"><meta property="og:type" content="article"><meta property="og:url" content="https://szulinek.pl/en/posts/traefik-docker/"><meta property="og:image" content="https://szulinek.pl/img/blog/traefik-logo.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-31T09:43:45+02:00"><meta property="article:modified_time" content="2023-08-31T09:43:45+02:00"><meta property="og:site_name" content="IT Tech Anytime"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://szulinek.pl/img/blog/traefik-logo.jpg"><meta name=twitter:title content="Traefik, Docker and SSL"><meta name=twitter:description content="Traefik reverse proxy"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":4,"name":"Traefik, Docker and SSL","item":"https://szulinek.pl/en/posts/traefik-docker/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Traefik, Docker and SSL","name":"Traefik, Docker and SSL","description":"Traefik reverse proxy","keywords":["docker","traefik"],"articleBody":"What is Traefik? Traefik is an open-source dynamic reverse proxy and load balancer. It’s often used as a tool for managing traffic in containerized environments, such as Docker. This tool enables automatic redirection of network traffic to different services based on defined configuration rules. Additionally, it supports various communication protocols including HTTP, TCP, and UDP.\nIn this guide, I’ll show you how to set up Traefik within Docker.\nBenefits of Using Traefik Traefik is a tool for routing network traffic in a microservices architecture. Its key advantages are:\nDynamic Configuration: Automatically detects new services and adjusts routing. Multiple Data Source Support: Can integrate with various configuration sources. Container Support: Easily manages traffic in Docker containers and other technologies. Built-in Security: Supports SSL certificates, authentication, and authorization. Load Balancing: Distributes traffic evenly among available services. Integration with Multiple Systems: Integrates with monitoring tools and orchestrators. Configuration in Docker Environment: The first step is to create a directory structure for Traefik:\nmkdir traefik cd traefik mkdir data cd data touch acme.json chmod 600 acme.json touch config.yml The directory structure should look like this:\n./traefik ├── data │ ├── acme.json │ ├── config.yml └── docker-compose.yml The traefik.yml file will look like this:\napi: dashboard: true debug: true entryPoints: http: address: \":80\" http: redirections: entryPoint: to: https scheme: https https: address: \":443\" serversTransport: insecureSkipVerify: true providers: docker: endpoint: \"unix:///var/run/docker.sock\" exposedByDefault: false file: filename: /config.yml certificatesResolvers: cloudflare: acme: email: you@example.com storage: acme.json dnsChallenge: provider: cloudflare resolvers: - \"1.1.1.1:53\" - \"1.0.0.1:53\" Next, create a network that Traefik will use, let’s name it “proxy”:\ndocker network create proxy The docker-compose.yml file will look like this:\nversion: '3' services: traefik: image: traefik:latest container_name: traefik restart: unless-stopped security_opt: - no-new-privileges:true networks: - proxy ports: - 80:80 - 443:443 environment: - CF_API_EMAIL=user@example.com - CF_DNS_API_TOKEN=YOUR_API_TOKEN volumes: - /etc/localtime:/etc/localtime:ro - /var/run/docker.sock:/var/run/docker.sock:ro - /home/username/traefik/data/traefik.yml:/traefik.yml:ro - /home/username/traefik/data/acme.json:/acme.json - /home/username/traefik/data/config.yml:/config.yml:ro labels: - \"traefik.enable=true\" - \"traefik.http.routers.traefik.entrypoints=http\" - \"traefik.http.routers.traefik.rule=Host(`traefik-dashboard.local.example.com`)\" - \"traefik.http.middlewares.traefik-auth.basicauth.users=USER:BASIC_AUTH_PASSWORD\" - \"traefik.http.middlewares.traefik-https-redirect.redirectscheme.scheme=https\" - \"traefik.http.middlewares.sslheader.headers.customrequestheaders.X-Forwarded-Proto=https\" - \"traefik.http.routers.traefik.middlewares=traefik-https-redirect\" - \"traefik.http.routers.traefik-secure.entrypoints=https\" - \"traefik.http.routers.traefik-secure.rule=Host(`traefik-dashboard.local.example.com`)\" - \"traefik.http.routers.traefik-secure.middlewares=traefik-auth\" - \"traefik.http.routers.traefik-secure.tls=true\" - \"traefik.http.routers.traefik-secure.tls.certresolver=cloudflare\" - \"traefik.http.routers.traefik-secure.tls.domains[0].main=local.example.com\" - \"traefik.http.routers.traefik-secure.tls.domains[0].sans=*.local.example.com\" - \"traefik.http.routers.traefik-secure.service=api@internal\" networks: proxy: external: true Then, in the data directory, create a config.yml file.\nSetting up BasicAuth Password: sudo apt update sudo apt install apache2-utils Generating BasicAuth Password Hash: echo $(htpasswd -nb \"\" \"\") | sed -e s/\\\\$/\\\\$\\\\$/g ","wordCount":"373","inLanguage":"en","image":"https://szulinek.pl/img/blog/traefik-logo.jpg","datePublished":"2023-08-31T09:43:45+02:00","dateModified":"2023-08-31T09:43:45+02:00","author":[{"@type":"Person","name":"Adam"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://szulinek.pl/en/posts/traefik-docker/"},"publisher":{"@type":"Organization","name":"IT Tech Anytime","logo":{"@type":"ImageObject","url":"https://szulinek.pl/assets/favicon/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://szulinek.pl/en/ accesskey=h title="Szulinek IT (Alt + H)"><img src=https://szulinek.pl/img/coding.png alt aria-label=logo height=35>Szulinek IT</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://szulinek.pl/pl/ title=Polski aria-label=:pl:>Pl</a></li></ul></div></div><ul id=menu><li><a href=https://szulinek.pl/en/about title=Whoami><span>Whoami</span></a></li><li><a href=https://szulinek.pl/en/services/ title=Services><span>Services</span></a></li><li><a href=https://szulinek.pl/en/posts/ title=Blog><span>Blog</span></a></li><li><a href=https://szulinek.pl/en/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://szulinek.pl/en/contact/ title=Contact><span>Contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://szulinek.pl/en/>Home</a></div><h1 class=post-title>Traefik, Docker and SSL</h1><div class=post-description>Traefik reverse proxy</div><div class=post-meta><span title='2023-08-31 09:43:45 +0200 CEST'>August 31, 2023</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;373 words&nbsp;·&nbsp;Adam&nbsp;|&nbsp;Translations:<ul class=i18n_list><li><a href=https://szulinek.pl/pl/posts/traefik-docker/>Pl</a></li></ul></div></header><figure class=entry-cover><img loading=lazy src=https://szulinek.pl/img/blog/traefik-logo.jpg alt=docker></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#what-is-traefik>What is Traefik?</a></li><li><a href=#benefits-of-using-traefik>Benefits of Using Traefik</a></li><li><a href=#configuration-in-docker-environment>Configuration in Docker Environment:</a></li><li><a href=#setting-up-basicauth-password>Setting up BasicAuth Password:</a></li><li><a href=#generating-basicauth-password-hash>Generating BasicAuth Password Hash:</a></li></ul></nav></div></details></div><div class=post-content><h2 id=what-is-traefik>What is Traefik?<a hidden class=anchor aria-hidden=true href=#what-is-traefik>#</a></h2><p>Traefik is an open-source dynamic reverse proxy and load balancer. It&rsquo;s often used as a tool for managing traffic in containerized environments, such as Docker. This tool enables automatic redirection of network traffic to different services based on defined configuration rules. Additionally, it supports various communication protocols including HTTP, TCP, and UDP.</p><p>In this guide, I&rsquo;ll show you how to set up Traefik within Docker.</p><h2 id=benefits-of-using-traefik>Benefits of Using Traefik<a hidden class=anchor aria-hidden=true href=#benefits-of-using-traefik>#</a></h2><p>Traefik is a tool for routing network traffic in a microservices architecture. Its key advantages are:</p><ul><li><strong>Dynamic Configuration:</strong> Automatically detects new services and adjusts routing.</li><li><strong>Multiple Data Source Support:</strong> Can integrate with various configuration sources.</li><li><strong>Container Support:</strong> Easily manages traffic in Docker containers and other technologies.</li><li><strong>Built-in Security:</strong> Supports SSL certificates, authentication, and authorization.</li><li><strong>Load Balancing:</strong> Distributes traffic evenly among available services.</li><li><strong>Integration with Multiple Systems:</strong> Integrates with monitoring tools and orchestrators.</li></ul><p><img loading=lazy src=/img/blog/traefik1.png alt=reverse-proxy title="Nextcloud reverse_proxy"></p><h2 id=configuration-in-docker-environment>Configuration in Docker Environment:<a hidden class=anchor aria-hidden=true href=#configuration-in-docker-environment>#</a></h2><p>The first step is to create a directory structure for Traefik:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir traefik
</span></span><span class=line><span class=cl><span class=nb>cd</span> traefik
</span></span><span class=line><span class=cl>mkdir data
</span></span><span class=line><span class=cl><span class=nb>cd</span> data
</span></span><span class=line><span class=cl>touch acme.json
</span></span><span class=line><span class=cl>chmod <span class=m>600</span> acme.json
</span></span><span class=line><span class=cl>touch config.yml
</span></span></code></pre></div><p>The directory structure should look like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./traefik
</span></span><span class=line><span class=cl>├── data
</span></span><span class=line><span class=cl>│   ├── acme.json
</span></span><span class=line><span class=cl>│   ├── config.yml
</span></span><span class=line><span class=cl>└── docker-compose.yml
</span></span></code></pre></div><p>The <strong>traefik.yml</strong> file will look like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>api</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>dashboard</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>entryPoints</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;:80&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>redirections</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>entryPoint</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>to</span><span class=p>:</span><span class=w> </span><span class=l>https</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>scheme</span><span class=p>:</span><span class=w> </span><span class=l>https</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>https</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;:443&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>serversTransport</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>insecureSkipVerify</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>providers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>docker</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;unix:///var/run/docker.sock&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>exposedByDefault</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>file</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>filename</span><span class=p>:</span><span class=w> </span><span class=l>/config.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>certificatesResolvers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>cloudflare</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>acme</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>email</span><span class=p>:</span><span class=w> </span><span class=l>you@example.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>storage</span><span class=p>:</span><span class=w> </span><span class=l>acme.json</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>dnsChallenge</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>provider</span><span class=p>:</span><span class=w> </span><span class=l>cloudflare</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>resolvers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=s2>&#34;1.1.1.1:53&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=s2>&#34;1.0.0.1:53&#34;</span><span class=w>
</span></span></span></code></pre></div><p>Next, create a <strong>network</strong> that Traefik will use, let&rsquo;s name it &ldquo;proxy&rdquo;:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker network create proxy
</span></span></code></pre></div><p>The <strong>docker-compose.yml</strong> file will look like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;3&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>traefik</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>traefik:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>traefik</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>unless-stopped</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>security_opt</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=kc>no</span>-<span class=l>new-privileges:true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>networks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>proxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>80</span><span class=p>:</span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>443</span><span class=p>:</span><span class=m>443</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>CF_API_EMAIL=user@example.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>CF_DNS_API_TOKEN=YOUR_API_TOKEN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/etc/localtime:/etc/localtime:ro</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/var/run/docker.sock:/var/run/docker.sock:ro</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/home/username/traefik/data/traefik.yml:/traefik.yml:ro</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/home/username/traefik/data/acme.json:/acme.json</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/home/username/traefik/data/config.yml:/config.yml:ro</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;traefik.enable=true&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;traefik.http.routers.traefik.entrypoints=http&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;traefik.http.routers.traefik.rule=Host(`traefik-dashboard.local.example.com`)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;traefik.http.middlewares.traefik-auth.basicauth.users=USER:BASIC_AUTH_PASSWORD&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;traefik.http.middlewares.traefik-https-redirect.redirectscheme.scheme=https&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;traefik.http.middlewares.sslheader.headers.customrequestheaders.X-Forwarded-Proto=https&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;traefik.http.routers.traefik.middlewares=traefik-https-redirect&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;traefik.http.routers.traefik-secure.entrypoints=https&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;traefik.http.routers.traefik-secure.rule=Host(`traefik-dashboard.local.example.com`)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;traefik.http.routers.traefik-secure.middlewares=traefik-auth&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;traefik.http.routers.traefik-secure.tls=true&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;traefik.http.routers.traefik-secure.tls.certresolver=cloudflare&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;traefik.http.routers.traefik-secure.tls.domains[0].main=local.example.com&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;traefik.http.routers.traefik-secure.tls.domains[0].sans=*.local.example.com&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;traefik.http.routers.traefik-secure.service=api@internal&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>networks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>proxy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>external</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span></code></pre></div><p>Then, in the <strong>data</strong> directory, create a <strong>config.yml</strong> file.</p><h2 id=setting-up-basicauth-password>Setting up BasicAuth Password:<a hidden class=anchor aria-hidden=true href=#setting-up-basicauth-password>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt update
</span></span><span class=line><span class=cl>sudo apt install apache2-utils
</span></span></code></pre></div><h2 id=generating-basicauth-password-hash>Generating BasicAuth Password Hash:<a hidden class=anchor aria-hidden=true href=#generating-basicauth-password-hash>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=k>$(</span>htpasswd -nb <span class=s2>&#34;&lt;USER&gt;&#34;</span> <span class=s2>&#34;&lt;PASSWORD&gt;&#34;</span><span class=k>)</span> <span class=p>|</span> sed -e s/<span class=se>\\</span>$/<span class=se>\\</span>$<span class=se>\\</span>$/g
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://szulinek.pl/en/tags/docker/>docker</a></li><li><a href=https://szulinek.pl/en/tags/traefik/>traefik</a></li></ul><nav class=paginav><a class=next href=https://szulinek.pl/en/posts/docker-nextcloud/><span class=title>Next »</span><br><span>Docker Nextcloud</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://szulinek.pl/en/>IT Tech Anytime</a></span>
<span>Powered by
<a href=https://szulinek.pl rel="noopener noreferrer" target=_blank>szulinek.pl</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script src=/js/custom.js></script></body></html>